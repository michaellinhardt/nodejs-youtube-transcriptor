# Implementation Plan: 1.4.4 - Set up ESLint and Prettier Configuration

**Date:** 2025-11-19
**Task:** 1.4.4 - Set up ESLint and Prettier configuration (implements 1.0 Project Initialization & Setup)
**Status:** Ready for Implementation
**Requirements:** TR-1 (Module Structure), Project standard practices

## Plan Overview

This plan implements linting and code formatting infrastructure for the nodejs-youtube-transcriptor project. ESLint provides static code analysis to catch bugs and enforce coding standards, while Prettier enforces consistent code formatting across the codebase. Together, they ensure code quality, maintainability, and consistency throughout development iterations.

The implementation establishes industry-standard configurations appropriate for a Node.js CLI tool, with sensible defaults that catch common errors while remaining pragmatic for a small project scope. This enables developers to catch issues early, maintain code consistency, and reduce code review friction in future contributions.

## Tasks Planned

- 1.4.4 [Set up ESLint and Prettier configuration]
  - Implementation of ESLint configuration with Node.js/JavaScript standards
  - Implementation of Prettier configuration for code formatting
  - Integration of both tools with pre-commit hooks
  - Configuration files properly positioned in project root

## High-Level Steps

1. Install ESLint and Prettier dependencies
2. Create ESLint configuration (.eslintrc.js)
3. Create Prettier configuration (.prettierrc)
4. Create .eslintignore and .prettierignore files
5. Add npm scripts for linting and formatting
6. Update package.json with proper configuration

## Detailed Implementation

### Step 1: Install ESLint and Prettier Dependencies

#### A. Rationale & Objective

ESLint and Prettier must be installed as development dependencies to provide linting and formatting capabilities. Using industry-standard versions ensures compatibility with existing tooling and community best practices.

#### B. Core Concepts & Strategy

Install the following packages as devDependencies:

- **eslint** (^8.50.0): Core linting engine for JavaScript
- **prettier** (^3.0.0): Opinionated code formatter
- **eslint-config-prettier** (^9.0.0): Disables ESLint rules that conflict with Prettier
- **eslint-plugin-node** (^11.1.0): ESLint plugin for Node.js best practices

These versions are compatible with Node.js v18+ and provide stable, well-supported configurations.

**Strategy:**

- Install as devDependencies (used during development only)
- Pin major versions but allow minor/patch updates
- Verify installation success before proceeding to configuration

#### C. Implementation Guidelines

**Key Logic:**

```bash
npm install --save-dev \
  eslint@^8.50.0 \
  prettier@^3.0.0 \
  eslint-config-prettier@^9.0.0 \
  eslint-plugin-node@^11.1.0
```

**Critical Points:**

- Install as `--save-dev` to add to package.json devDependencies
- Verify package.json reflects new dependencies before proceeding
- Check node_modules for presence of all packages

#### D. Success Criteria

- [ ] All four packages installed in node_modules
- [ ] package.json devDependencies section updated with new versions
- [ ] npm install completes without errors
- [ ] Subsequent `npm install` from clean state works correctly

#### E. Dependencies & Inputs

- Requires: Node.js v18+, npm, existing package.json
- Produces: package-lock.json updated, node_modules containing ESLint/Prettier

### Step 2: Create ESLint Configuration (.eslintrc.js)

#### A. Rationale & Objective

ESLint configuration centralizes linting rules in a single file, enabling consistent code quality checks across the project. The configuration must extend Node.js best practices while remaining pragmatic for a small CLI tool.

#### B. Core Concepts & Strategy

Create `.eslintrc.js` in project root with:

- **Environment**: node=true (Node.js globals), es2021=true (modern JavaScript)
- **Parser Options**: ecmaVersion 2021 for modern syntax support
- **Extends**: eslint-config-prettier to prevent conflicts with Prettier
- **Plugins**: eslint-plugin-node for Node.js-specific rules
- **Rules**: Sensible defaults for catching common errors without being overly strict

Configuration strategy balances catching bugs with avoiding false positives for a small project.

#### C. Implementation Guidelines

**Key Logic:**

```javascript
module.exports = {
  env: {
    node: true,
    es2021: true,
  },
  extends: ['eslint:recommended', 'plugin:node/recommended', 'prettier'],
  parserOptions: {
    ecmaVersion: 2021,
    sourceType: 'module',
  },
  plugins: ['node'],
  rules: {
    // Core error prevention
    'no-console': 'warn',
    'no-unused-vars': ['error', { argsIgnorePattern: '^_' }],
    'no-process-exit': 'off',

    // Node.js specific
    'node/no-unsupported-features/es-syntax': 'off',
    'node/no-unpublished-require': 'off',
    'node/no-unpublished-import': 'off',
    'node/exports-style': ['error', 'module.exports'],

    // Best practices
    'prefer-const': 'error',
    'no-var': 'error',
    eqeqeq: ['error', 'always'],
    curly: ['error', 'all'],
  },
  overrides: [
    {
      files: ['bin/**', 'src/**'],
      rules: {
        'no-console': 'off', // Allow console in CLI tool
      },
    },
  ],
};
```

**Critical Points:**

- Include `'prettier'` in extends to disable conflicting rules
- Set `'no-console': 'off'` for bin/ and src/ directories (CLI tool logs intentionally)
- Use `argsIgnorePattern: '^_'` to allow unused parameters prefixed with underscore
- sourceType must be 'module' to support modern imports (if used)

#### D. Success Criteria

- [ ] .eslintrc.js file created in project root
- [ ] File contains valid JavaScript object export
- [ ] ESLint successfully loads configuration: `npx eslint --print-config .`
- [ ] No validation errors from ESLint

#### E. Dependencies & Inputs

- Requires: Step 1 (dependencies installed)
- Produces: .eslintrc.js configuration file
- Input files: None (creation only)

### Step 3: Create Prettier Configuration (.prettierrc)

#### A. Rationale & Objective

Prettier configuration ensures consistent code formatting across the project. A unified formatting style reduces friction in code reviews and eliminates style-related discussions.

#### B. Core Concepts & Strategy

Create `.prettierrc` (JSON format) with:

- **printWidth**: 100 (balanced for modern displays, readable without wrapping excessively)
- **tabWidth**: 2 (standard for Node.js projects)
- **useTabs**: false (spaces, standard practice)
- **semi**: true (enforce semicolons for consistency)
- **singleQuote**: true (single quotes, matches many Node.js conventions)
- **trailingComma**: 'es5' (trailing commas where valid in ES5, aids diffs)
- **bracketSpacing**: true (spaces in object literals)
- **arrowParens**: 'always' (parentheses around arrow function parameters)

Strategy focuses on readability while maintaining consistency with Node.js community standards.

#### C. Implementation Guidelines

**Key Logic:**

```json
{
  "printWidth": 100,
  "tabWidth": 2,
  "useTabs": false,
  "semi": true,
  "singleQuote": true,
  "trailingComma": "es5",
  "bracketSpacing": true,
  "arrowParens": "always",
  "endOfLine": "lf"
}
```

**Critical Points:**

- JSON format (not JavaScript) for simplicity and tooling compatibility
- printWidth=100 avoids excessive line wrapping while keeping lines readable
- semi=true and singleQuote=true enforce consistency across codebase
- endOfLine='lf' ensures Unix line endings (important for cross-platform compatibility)

#### D. Success Criteria

- [ ] .prettierrc file created in project root
- [ ] File contains valid JSON object
- [ ] Prettier successfully reads configuration: `npx prettier --version`
- [ ] No validation errors from Prettier

#### E. Dependencies & Inputs

- Requires: Step 1 (dependencies installed)
- Produces: .prettierrc configuration file
- Input files: None (creation only)

### Step 4: Create Ignore Files (.eslintignore and .prettierignore)

#### A. Rationale & Objective

Ignore files prevent linting and formatting checks on files that shouldn't be analyzed (dependencies, generated files, build outputs). This improves performance and prevents false positives on third-party code.

#### B. Core Concepts & Strategy

Create two ignore files:

1. **.eslintignore**: Patterns for files ESLint should skip
2. **.prettierignore**: Patterns for files Prettier should skip

Both files share common patterns for consistency. Strategy minimizes false positives while covering all third-party and generated content.

#### C. Implementation Guidelines

**Key Logic - .eslintignore:**

```
node_modules
dist
build
.next
.nuxt
out
coverage
.nyc_output
.env
.env.*
!.env.example
package-lock.json
yarn.lock
```

**Key Logic - .prettierignore:**

```
node_modules
dist
build
.next
.nuxt
out
coverage
.nyc_output
.env
.env.*
!.env.example
package-lock.json
yarn.lock
.git
```

**Critical Points:**

- Exclude node_modules to avoid checking thousands of dependency files
- Exclude environment files (.env) to prevent exposure of secrets
- Use `!.env.example` to include the example file (inverse pattern)
- Include lock files which shouldn't be formatted
- Add version control directory (.git) to .prettierignore

#### D. Success Criteria

- [ ] .eslintignore file created in project root with appropriate patterns
- [ ] .prettierignore file created in project root with appropriate patterns
- [ ] Both files have no syntax errors
- [ ] ESLint respects ignore patterns: `npx eslint --print-config node_modules` (should skip)
- [ ] Prettier respects ignore patterns

#### E. Dependencies & Inputs

- Requires: Steps 1-3 (ESLint and Prettier installed and configured)
- Produces: .eslintignore and .prettierignore files
- Input files: None (creation only)

### Step 5: Add npm Scripts for Linting and Formatting

#### A. Rationale & Objective

npm scripts provide convenient commands for developers to lint and format code. Scripts standardize the commands used during development and CI/CD pipelines.

#### B. Core Concepts & Strategy

Add four npm scripts to package.json:

1. **lint**: Run ESLint to check for errors
2. **lint:fix**: Run ESLint with --fix to automatically correct issues
3. **format**: Run Prettier to format code (write mode)
4. **format:check**: Run Prettier in check mode (no writes, reports differences)

Strategy provides both checking and fixing capabilities, with non-destructive check options for CI/CD verification.

#### C. Implementation Guidelines

**Key Logic - package.json scripts section:**

```json
{
  "scripts": {
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "format": "prettier --write .",
    "format:check": "prettier --check .",
    "lint:all": "npm run lint && npm run format:check"
  }
}
```

**Critical Points:**

- `lint` command should be non-destructive (check only)
- `lint:fix` automatically corrects fixable violations
- `format` uses `--write` to modify files
- `format:check` uses `--check` for CI verification without modifications
- `lint:all` combines all checks for comprehensive validation

#### D. Success Criteria

- [ ] Scripts section in package.json updated with lint and format commands
- [ ] `npm run lint` executes without errors (may report issues, that's expected)
- [ ] `npm run format:check` executes and reports formatting status
- [ ] `npm run lint:fix` executes and auto-fixes issues
- [ ] `npm run format` executes and auto-formats code

#### E. Dependencies & Inputs

- Requires: Steps 1-4 (dependencies installed, configurations created)
- Produces: Updated package.json with npm scripts
- Input files: package.json (modified in-place)

### Step 6: Update package.json Configuration

#### A. Rationale & Objective

Centralize configuration references in package.json for consistency and discoverability. Some tools benefit from having configuration pointers or metadata in package.json.

#### B. Core Concepts & Strategy

Add optional configuration metadata to package.json:

- **engines**: Specify Node.js version requirements (v18.0.0+)
- **scripts**: Already covered in Step 5
- **devDependencies**: Already handled in Step 1

Additional improvements for code quality management visibility.

#### C. Implementation Guidelines

**Key Logic - package.json engines section:**

```json
{
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=9.0.0"
  }
}
```

**Critical Points:**

- Specify minimum Node.js version (18.0.0 per TR-1)
- Specify minimum npm version for consistency
- This ensures developers use compatible versions
- Aids in troubleshooting environment-related issues

#### D. Success Criteria

- [ ] package.json contains engines section with Node.js v18.0.0+ requirement
- [ ] package.json contains all scripts from Step 5
- [ ] package.json is valid JSON (parseable by `npm run`)
- [ ] `npm run lint` and `npm run format` are discoverable via `npm run`

#### E. Dependencies & Inputs

- Requires: Steps 1-5 (all previous setup complete)
- Produces: Updated package.json with engines and complete script configuration
- Input files: package.json (modified in-place)

## Task Breakdown Updates

### Subtasks Completed Within This Plan

All subtasks for 1.4.4 are completed within the steps above:

1. **Install ESLint and Prettier dependencies** (Step 1)
2. **Create ESLint configuration** (Step 2)
3. **Create Prettier configuration** (Step 3)
4. **Create ignore files** (Step 4)
5. **Add npm scripts** (Step 5)
6. **Update package.json** (Step 6)

No additional subtasks identified beyond the initial plan scope.

## Technical Considerations

### Architecture Impact

- **No runtime impact**: ESLint and Prettier are development-only tools
- **No API changes**: Existing module structure remains unchanged
- **Zero production dependencies**: All tools are devDependencies
- **Development workflow enhancement**: Enables faster iteration and fewer style-related issues

### Integration Points

- **package.json**: Central configuration hub for npm scripts and engines
- **Development workflow**: Scripts integrate with developer commands (lint, format before commit)
- **CI/CD compatibility**: `npm run format:check` and `npm run lint` for automation
- **Pre-commit hooks**: Optional future integration for automatic formatting

### Risk Mitigation

| Risk                         | Likelihood | Impact | Mitigation Strategy                                                             |
| ---------------------------- | ---------- | ------ | ------------------------------------------------------------------------------- |
| Configuration conflicts      | Low        | Medium | eslint-config-prettier disables conflicting rules; test integration after setup |
| Breaking existing formatting | Low        | Low    | Run format:check first to verify, review changes before committing              |
| Version incompatibility      | Very Low   | High   | Pin to tested versions (ESLint ^8.50.0, Prettier ^3.0.0); verify with Node v18+ |
| Overly strict rules          | Medium     | Low    | Start with recommended defaults; adjust rules.js based on team feedback         |

### Performance Considerations

- **Linting time**: ESLint processes entire codebase quickly (small project, <50 files expected)
- **Formatting time**: Prettier writes minimal changes, typical run <1 second
- **No performance impact on runtime**: Development tools only
- **Monitoring points**: Track npm script execution time; alert if exceeds 5 seconds

## Testing Strategy

### Unit Testing

Not applicable for configuration-only implementation.

### Integration Testing

- **Configuration validation**: ESLint and Prettier successfully read all configuration files
- **Script execution**: All npm scripts execute without errors on current codebase
- **Consistency check**: ESLint and Prettier don't conflict (no rules triggering both)

### Edge Cases

- Empty project (no files to lint/format)
- Files with mixed line endings (LF enforcement)
- Conflicting ESLint/Prettier rules (prevented by eslint-config-prettier)
- Permission issues on ignore files (unlikely but monitor)

## Implementation Notes

### Code Organization

```folder
project/
├── .eslintrc.js           # ESLint configuration (new)
├── .prettierrc            # Prettier configuration (new)
├── .eslintignore          # ESLint ignore patterns (new)
├── .prettierignore        # Prettier ignore patterns (new)
├── package.json           # Updated with scripts and engines
├── node_modules/          # Contains eslint, prettier, plugins
├── src/                   # Source code (unchanged)
├── bin/                   # CLI entry point (unchanged)
└── docs/                  # Documentation (unchanged)
```

### Coding Standards

- **Configuration files**: Use standard naming conventions (.eslintrc.js, .prettierrc)
- **JSON format**: Prettier uses .prettierrc (JSON) for simplicity
- **JavaScript format**: ESLint uses .eslintrc.js for Node-specific features if needed
- **Consistency**: Both tools configured with complementary rules (never conflicting)

### Documentation Requirements

- **Inline comments**: Configuration files include brief explanations of key options
- **README updates**: Add linting and formatting section explaining usage
- **Development guide**: Document pre-commit and continuous integration linting practices

## Estimated Effort

| Component                         | Effort    | Complexity   |
| --------------------------------- | --------- | ------------ |
| Install dependencies (Step 1)     | 30 min    | Low          |
| Create ESLint config (Step 2)     | 45 min    | Low          |
| Create Prettier config (Step 3)   | 20 min    | Low          |
| Create ignore files (Step 4)      | 15 min    | Low          |
| Add npm scripts (Step 5)          | 15 min    | Low          |
| Update package.json (Step 6)      | 10 min    | Low          |
| Verify integration & test scripts | 30 min    | Low          |
| **Total**                         | 2.5 hours | Overall: Low |

## Next Steps

1. Execute Step 1: Install dependencies via npm
2. Create .eslintrc.js in project root
3. Create .prettierrc in project root
4. Create .eslintignore and .prettierignore files
5. Add npm scripts to package.json
6. Run `npm run lint` and `npm run format:check` to verify setup
7. Mark task 1.4.4 as complete in ./dev/tasks.md
8. Proceed to tasks in section 9.0 or other pending work

## References

- **Functional Requirements**: FR-1 (core project scope), general code quality
- **Technical Requirements**: TR-1 (Module Structure - linting supports maintainability)
- **Related Tasks**: 1.0 (Project Initialization), completed tasks 2.0-8.0 (provide context)
- **External Documentation**:
  - [ESLint Documentation](https://eslint.org/docs/latest/)
  - [Prettier Documentation](https://prettier.io/docs/en/index.html)
  - [ESLint Node.js Plugin](https://github.com/mysticatea/eslint-plugin-node)
  - [ESLint Config Prettier](https://github.com/prettier/eslint-config-prettier)
